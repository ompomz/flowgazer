<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>okkake</title>
<style>
:root { --bg: #f7f7f7; --txt: #666; --panel: #f7f7f7; --accent: #ffcc66; --link: #66b3ff; --border: #ddd; }
/* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ç”¨ã®å¤‰æ•°å®šç¾©ï¼ˆbodyã«.dark-modeã‚¯ãƒ©ã‚¹ãŒã¤ã„ãŸæ™‚ã€ã¾ãŸã¯OSè¨­å®šãŒãƒ€ãƒ¼ã‚¯ã®æ™‚ï¼‰ */
body.dark-mode { --bg: #132639; --txt: #ccc; --panel: #132639; --accent: #f0ad4e; --link: #4da3ff; --border: #444; }
@media (prefers-color-scheme: dark) { body:not(.light-mode) { --bg: #132639; --txt: #ccc; --panel: #132639; --accent: #f0ad4e; --link: #4da3ff; --border: #444; } }


* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-weight: 400; padding: 0.5rem; line-height: 1.3; background-color: var(--bg); color: var(--txt); font-size: 0.9rem; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Sans","Hiragino Kaku Gothic ProN","Noto Sans JP","Helvetica Neue",Arial,sans-serif; }
.container { max-width: 600px; margin: 0.5rem; }
input, select, textarea { font-size: 0.9rem; padding: 0.3rem 0.5rem; border: 1px solid var(--border); border-radius: 4px; color: var(--txt); background-color: var(--panel); margin: 2px; }
button { white-space: nowrap; font-size: 0.8rem; font-weight: 700; padding: 4px 12px; border: none; border-radius: 999px; cursor: pointer; background-color: var(--accent); color: #f7f7f7; margin: 2px; }
.event { word-break: break-all; padding: 0.4rem 0.25rem; border-top: 1px dashed var(--border); }
.event.is-favored { border-right: 5px solid #ffeb3b; }
.time, .author, .nostr-ref, .pubkey-ref { color: var(--link); text-decoration: none; font-weight: normal; }
.post-content { display: inline; color: var(--txt); }


/* è¦ªè¦ç´ ã‚’Flexãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹ */
.magicalcontainer {
  display: flex;
  flex-direction: column;
}


/* --- é€šå¸¸æ™‚ï¼ˆæ˜‡é †ï¼šå¤ã„é †ï¼‰ --- */
#older { order: 1; }      /* éå»ãƒœã‚¿ãƒ³ãŒä¸Š */
#timeline { order: 2; }   /* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãŒçœŸã‚“ä¸­ */
#newer { order: 3; }      /* æœªæ¥ãƒœã‚¿ãƒ³ãŒä¸‹ */


#older::before { content: "â–² "; } /* éå»ã¯ä¸Šå‘ã */
#newer::before { content: "â–¼ "; } /* æœªæ¥ã¯ä¸‹å‘ã */


/* --- é™é †ï¼ˆæ–°ã—ã„é †ï¼‰ã®ã¨ã --- */
.magicalcontainer.is-desc #newer { order: 1; }  /* æœªæ¥ãƒœã‚¿ãƒ³ãŒä¸€ç•ªä¸Šã¸ãƒ¯ãƒ¼ãƒ—ï¼ */
.magicalcontainer.is-desc #timeline { order: 2; }
.magicalcontainer.is-desc #older { order: 3; }  /* éå»ãƒœã‚¿ãƒ³ãŒä¸€ç•ªä¸‹ã¸ãƒ¯ãƒ¼ãƒ—ï¼ */


.magicalcontainer.is-desc #newer::before { content: "â–² "; }
.magicalcontainer.is-desc #older::before { content: "â–¼ "; }

.switch {
  position: relative;
  display: inline-block;
  width: 50px;   /* â† 52px â†’ 50px ã«ã™ã‚‹ã¨æ¯”ç‡ãŒæ•´ã† */
  height: 26px;
}


.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}


.slider {
  position: absolute;
  cursor: pointer;
  inset: 0;
  background: var(--border);
  border-radius: 26px;
  transition: 0.3s;
}


.slider:before {
  content: "";
  position: absolute;
  height: 20px;
  width: 20px;
  left: 3px;     /* â† ä½™ç™½ã¯ãã®ã¾ã¾ã§OK */
  bottom: 3px;
  background: var(--panel);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  transition: 0.3s;
}


/* ON */
input:checked + .slider {
  background: var(--link);
}


input:checked + .slider:before {
  transform: translateX(24px);
  content: "";
}

/* ------------------- */

/* ã‚³ãƒ³ãƒ†ãƒŠã‚’å³ä¸‹ã«å›ºå®š */
.floating-btn-container {
  position: fixed;
  bottom: 4rem;
  right: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  z-index: 100;

  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
}

.floating-btn-container.is-visible {
  opacity: 0.6;
  pointer-events: auto;
}

/* ãƒœã‚¿ãƒ³å…±é€š */
.floating-btn {
  height: 2.5rem;
  width: 2.5rem;
  background-color: var(--link);
  color: white;
  border: none;
  border-radius: 999px;
  cursor: pointer;
  font-size: 1.5rem;
  font-weight: normal;
  display: flex;
  justify-content: center;
  align-items: center;
  padding-top: 0;
  transition: opacity 0.3s;
}

.floating-btn:hover {
  opacity: 1;
}

/* è¨­å®šãƒœã‚¿ãƒ³ã ã‘è‰²ã‚’å¤‰ãˆãŸã„å ´åˆ */
.settings-btn {
  background-color: var(--gray);
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®èƒŒæ™¯ï¼ˆé»’ã„åŠé€æ˜ï¼‰ */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  display: none; /* æœ€åˆã¯éè¡¨ç¤º */
  justify-content: center;
  align-items: center;
  z-index: 200; /* ãƒœã‚¿ãƒ³ã‚ˆã‚Šå‰ã«å‡ºã™ */
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ä¸­èº« */
.modal-content {
  background: white;
  padding: 1.5rem;
  border-radius: 0.5rem;
  width: 90%;
  max-width: 400px;
}

/* é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ */
.close-btn {
  margin-top: 1rem;
  padding: 0.5rem 1rem;
}


</style>
</head>
<body>
<div class="container">

  <div class="flex-container">
    <input type="text" id="eventId" placeholder="nevent...">
    <input type="text" id="relay" placeholder="wss://...">
    <input type="text" id="pubkey" placeholder="npub...">
    <button id="load">å–å¾—</button>
  </div>

  <div class="magicalcontainer">
    <button id="older">ã‚‚ã£ã¨è¦‹ã‚‹</button>    
    <ul id="timeline" style="list-style: none;"></ul>
    <button id="newer">ã‚‚ã£ã¨è¦‹ã‚‹</button>
  </div>

</div>
<div class="floating-btn-container">
  <button id="go-to-origin" class="floating-btn">â®</button>
  <button id="open-settings" class="floating-btn settings-btn">âš™ï¸</button>
</div>

<div id="settings-modal" class="modal">
  <div class="modal-content">
    <h4>settings</h4>
    <span>è¡¨ç¤ºé †</span>
    <select id="sort-order">
    <option value="asc">â†‘éå»/ç¾åœ¨â†“</option>
    <option value="desc">â†‘ç¾åœ¨/éå»â†“</option>
    </select><br>
    <span>ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</span>
    <div class="switch-container">
    <label class="switch">
    <input type="checkbox" id="theme-toggle">
    <span class="slider"></span>
    </label>
    </div>
    <span>ãµãã¼ãƒãƒ¼ã‚¯</span>
    <input id="kind-7-content-input" type="text" maxlength="10" value="â­" style="width: 2.5rem; height: 1.5rem; text-align: center; font-size: 0.9rem; vertical-align: middle; border: 1px solid #ccc; border-radius: 4px; display: inline-block;"><br>
    <button id="close-settings" class="close-btn">ã¨ã˜ã‚‹</button>
  </div>
</div>


<script>
const sortSelect = document.getElementById("sort-order");
const container = document.querySelector(".magicalcontainer");


sortSelect.onchange = function() {
  timeline.sortOrder = this.value;
 
  if (this.value === 'desc') {
    container.classList.add("is-desc");
  } else {
    container.classList.remove("is-desc");
  }
 
  timeline.render();
};


const themeToggle = document.getElementById('theme-toggle');


themeToggle.onchange = function() {
  if (this.checked) {
    // ã‚¹ã‚¤ãƒƒãƒãŒON = ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹
    document.body.classList.remove('light-mode');
    document.body.classList.add('dark-mode');
    console.log("ğŸŒ™ Dark mode activated");
  } else {
    // ã‚¹ã‚¤ãƒƒãƒãŒOFF = ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹
    document.body.classList.remove('dark-mode');
    document.body.classList.add('light-mode');
    console.log("â˜€ï¸ Light mode activated");
  }
};

// è¨­å®šãƒœã‚¿ãƒ³
document.getElementById("open-settings").onclick = function () {
  document.getElementById("settings-modal").style.display = "flex";
};

// é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
document.getElementById("close-settings").onclick = function () {
  document.getElementById("settings-modal").style.display = "none";
};

// èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
document.getElementById("settings-modal").onclick = function (e) {
  if (e.target === this) {
    this.style.display = "none";
  }
};

</script>
<script src="https://unpkg.com/nostr-tools@2.17.0/lib/nostr.bundle.js"></script>
<script src="https://ompomz.github.io/flowgazer/relay-manager.js"></script>
<script src="./okkake.js"></script>
<script src="./sendfav.js"></script>
</body>
</html>